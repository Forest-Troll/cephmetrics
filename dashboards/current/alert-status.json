{
	"meta": {
		"type": "db",
		"canSave": true,
		"canEdit": true,
		"canStar": true,
		"slug": "alert-status",
		"expires": "0001-01-01T00:00:00Z",
		"created": "2017-07-23T22:23:27Z",
		"updated": "2017-07-23T22:40:32Z",
		"updatedBy": "admin@localhost",
		"createdBy": "admin@localhost",
		"version": 1
	},
	"dashboard": {
		"annotations": {
			"list": []
		},
		"editable": true,
		"gnetId": null,
		"graphTooltip": 0,
		"hideControls": false,
		"id": 45,
		"links": [],
		"refresh": "30s",
		"rows": [{
			"collapse": false,
			"height": "250px",
			"panels": [{
				"id": 1,
				"limit": "20",
				"links": [],
				"onlyAlertsOnDashboard": true,
				"show": "current",
				"sortOrder": 3,
				"span": 12,
				"stateFilter": ["alerting"],
				"title": "Active Ceph Alert List",
				"type": "alertlist"
			}],
			"repeat": null,
			"repeatIteration": null,
			"repeatRowId": null,
			"showTitle": false,
			"title": "Dashboard Row",
			"titleSize": "h6"
		}, {
			"collapse": false,
			"height": 250,
			"panels": [{
				"alert": {
					"conditions": [{
						"evaluator": {
							"params": [0],
							"type": "gt"
						},
						"operator": {
							"type": "and"
						},
						"query": {
							"params": ["A", "5m", "now"]
						},
						"reducer": {
							"params": [],
							"type": "avg"
						},
						"type": "query"
					}],
					"executionErrorState": "keep_state",
					"frequency": "30s",
					"handler": 1,
					"message": "Cluster Health is not OK",
					"name": "Overall Ceph Health",
					"noDataState": "no_data",
					"notifications": []
				},
				"aliasColors": {
					"Ceph Health": "#890F02",
					"Ceph Health (0:OK, 4:Warning,8:Error)": "#DEDAF7"
				},
				"bars": true,
				"dashLength": 10,
				"dashes": false,
				"datasource": null,
				"description": "The chart plots the clusters health, over time. Health is depicted as a integer; 0, 4 or 8 where 0 is OK, 4 is WARN and 8 represents an ERROR state.",
				"fill": 1,
				"hideTimeOverride": true,
				"id": 2,
				"legend": {
					"avg": false,
					"current": false,
					"max": false,
					"min": false,
					"show": true,
					"total": false,
					"values": false
				},
				"lines": false,
				"linewidth": 2,
				"links": [],
				"minSpan": 2,
				"nullPointMode": "null",
				"percentage": false,
				"pointradius": 5,
				"points": false,
				"renderer": "flot",
				"seriesOverrides": [],
				"spaceLength": 10,
				"span": 2,
				"stack": false,
				"steppedLine": true,
				"targets": [{
					"refId": "A",
					"target": "alias(limit(sortByMaxima(consolidateBy(collectd.*.$domain.cephmetrics.gauge.*.mon.health, \"max\")),1), 'Ceph Health')",
					"textEditor": true
				}],
				"thresholds": [{
					"colorMode": "critical",
					"fill": true,
					"line": true,
					"op": "gt",
					"value": 0
				}],
				"timeFrom": "1h",
				"timeShift": null,
				"title": "Overall Ceph Health",
				"tooltip": {
					"shared": false,
					"sort": 1,
					"value_type": "individual"
				},
				"type": "graph",
				"xaxis": {
					"buckets": null,
					"mode": "time",
					"name": null,
					"show": true,
					"values": []
				},
				"yaxes": [{
					"format": "short",
					"label": "",
					"logBase": 1,
					"max": "10",
					"min": "0",
					"show": true
				}, {
					"format": "short",
					"label": null,
					"logBase": 1,
					"max": null,
					"min": null,
					"show": false
				}]
			}, {
				"alert": {
					"conditions": [{
						"evaluator": {
							"params": [0],
							"type": "gt"
						},
						"operator": {
							"type": "and"
						},
						"query": {
							"params": ["A", "5m", "now"]
						},
						"reducer": {
							"params": [],
							"type": "avg"
						},
						"type": "query"
					}],
					"executionErrorState": "keep_state",
					"frequency": "60s",
					"handler": 1,
					"message": "DIsks Near full detected within the cluster. Warning threshold is 80% full.",
					"name": "Disks Near Full",
					"noDataState": "ok",
					"notifications": []
				},
				"aliasColors": {},
				"bars": false,
				"dashLength": 10,
				"dashes": false,
				"datasource": null,
				"description": "This shows how many disks are at or above 80% full. Performance may degrade beyond this threshold on filestore (XFS) backed OSD's.",
				"fill": 1,
				"id": 3,
				"legend": {
					"avg": false,
					"current": false,
					"max": false,
					"min": false,
					"show": true,
					"total": false,
					"values": false
				},
				"lines": true,
				"linewidth": 1,
				"links": [],
				"minSpan": 2,
				"nullPointMode": "null",
				"percentage": false,
				"pointradius": 5,
				"points": false,
				"renderer": "flot",
				"seriesOverrides": [],
				"spaceLength": 10,
				"span": 2,
				"stack": false,
				"steppedLine": false,
				"targets": [{
					"refId": "A",
					"target": "alias(countSeries(currentAbove(collectd.*.$domain.cephmetrics.gauge.*.osd.*.fs_percent_used,80)), \"disks near full\")",
					"textEditor": true
				}],
				"thresholds": [{
					"colorMode": "critical",
					"fill": true,
					"line": true,
					"op": "gt",
					"value": 0
				}],
				"timeFrom": null,
				"timeShift": null,
				"title": "Disks Near Full",
				"tooltip": {
					"shared": true,
					"sort": 0,
					"value_type": "individual"
				},
				"type": "graph",
				"xaxis": {
					"buckets": null,
					"mode": "time",
					"name": null,
					"show": true,
					"values": []
				},
				"yaxes": [{
					"format": "short",
					"label": null,
					"logBase": 1,
					"max": null,
					"min": "0",
					"show": true
				}, {
					"format": "short",
					"label": null,
					"logBase": 1,
					"max": null,
					"min": null,
					"show": true
				}]
			}, {
				"alert": {
					"conditions": [{
						"evaluator": {
							"params": [0],
							"type": "gt"
						},
						"operator": {
							"type": "and"
						},
						"query": {
							"params": ["C", "10s", "now"]
						},
						"reducer": {
							"params": [],
							"type": "last"
						},
						"type": "query"
					}],
					"executionErrorState": "alerting",
					"frequency": "10s",
					"handler": 1,
					"message": "OSD Down event",
					"name": "OSDs Down",
					"noDataState": "ok",
					"notifications": []
				},
				"aliasColors": {},
				"bars": true,
				"dashLength": 10,
				"dashes": false,
				"datasource": null,
				"description": "Count of OSDs currently in a DOWN state",
				"fill": 2,
				"hideTimeOverride": true,
				"id": 4,
				"legend": {
					"alignAsTable": false,
					"avg": false,
					"current": false,
					"hideZero": false,
					"max": false,
					"min": false,
					"rightSide": false,
					"show": false,
					"total": false,
					"values": false
				},
				"lines": false,
				"linewidth": 2,
				"links": [],
				"minSpan": 2,
				"nullPointMode": "null",
				"percentage": false,
				"pointradius": 5,
				"points": false,
				"renderer": "flot",
				"seriesOverrides": [],
				"spaceLength": 10,
				"span": 2,
				"stack": false,
				"steppedLine": true,
				"targets": [{
					"hide": true,
					"refId": "A",
					"target": "alias(keepLastValue(consolidateBy(maxSeries(collectd.*.$domain.cephmetrics.gauge.*.mon.num_osd), \"max\")),\"total\")",
					"textEditor": true
				}, {
					"hide": true,
					"refId": "B",
					"target": "alias(keepLastValue(consolidateBy(maxSeries(collectd.*.$domain.cephmetrics.gauge.*.mon.num_osd_up), \"max\")),\"up\")",
					"textEditor": true
				}, {
					"hide": false,
					"refId": "C",
					"target": "alias(diffSeries(#A,#B), \"down\")",
					"targetFull": "alias(diffSeries(alias(keepLastValue(consolidateBy(maxSeries(collectd.*.$domain.cephmetrics.gauge.*.mon.num_osd), \"max\")),\"total\"),alias(keepLastValue(consolidateBy(maxSeries(collectd.*.$domain.cephmetrics.gauge.*.mon.num_osd_up), \"max\")),\"up\")), \"down\")",
					"textEditor": true
				}],
				"thresholds": [{
					"colorMode": "critical",
					"fill": true,
					"line": true,
					"op": "gt",
					"value": 0
				}],
				"timeFrom": "5m",
				"timeShift": null,
				"title": "OSDs Down",
				"tooltip": {
					"shared": true,
					"sort": 0,
					"value_type": "individual"
				},
				"type": "graph",
				"xaxis": {
					"buckets": null,
					"mode": "time",
					"name": null,
					"show": true,
					"values": []
				},
				"yaxes": [{
					"format": "short",
					"label": null,
					"logBase": 1,
					"max": null,
					"min": "0",
					"show": true
				}, {
					"format": "short",
					"label": null,
					"logBase": 1,
					"max": null,
					"min": null,
					"show": false
				}]
			}, {
				"alert": {
					"conditions": [{
						"evaluator": {
							"params": [80],
							"type": "gt"
						},
						"operator": {
							"type": "and"
						},
						"query": {
							"params": ["C", "1h", "now"]
						},
						"reducer": {
							"params": [],
							"type": "avg"
						},
						"type": "query"
					}],
					"executionErrorState": "alerting",
					"frequency": "60s",
					"handler": 1,
					"message": "Cluster Capacity Limit Warning",
					"name": "Cluster Capacity",
					"noDataState": "keep_state",
					"notifications": []
				},
				"aliasColors": {},
				"bars": false,
				"dashLength": 10,
				"dashes": false,
				"datasource": null,
				"description": "This trigger raises a notification if the raw used crosses the 80% capacity threshold of the ceph cluster",
				"fill": 1,
				"id": 5,
				"legend": {
					"avg": false,
					"current": false,
					"max": false,
					"min": false,
					"show": true,
					"total": false,
					"values": false
				},
				"lines": true,
				"linewidth": 1,
				"links": [],
				"minSpan": 2,
				"nullPointMode": "null",
				"percentage": false,
				"pointradius": 5,
				"points": false,
				"renderer": "flot",
				"seriesOverrides": [],
				"spaceLength": 10,
				"span": 2,
				"stack": false,
				"steppedLine": false,
				"targets": [{
					"hide": true,
					"refId": "A",
					"target": "alias(maxSeries(groupByNode(collectd.*.$domain.cephmetrics.gauge.*.mon.osd_bytes,1, \"maxSeries\")), \"Raw Capacity\")",
					"textEditor": true
				}, {
					"hide": true,
					"refId": "B",
					"target": "alias(maxSeries(groupByNode(collectd.*.$domain.cephmetrics.gauge.*.mon.osd_bytes_used,1, \"maxSeries\")), \"Used Raw\")",
					"textEditor": true
				}, {
					"refId": "C",
					"target": "alias(asPercent(#B, #A), \"Raw Capacity Used %\")",
					"targetFull": "alias(asPercent(alias(maxSeries(groupByNode(collectd.*.$domain.cephmetrics.gauge.*.mon.osd_bytes_used,1, \"maxSeries\")), \"Used Raw\"), alias(maxSeries(groupByNode(collectd.*.$domain.cephmetrics.gauge.*.mon.osd_bytes,1, \"maxSeries\")), \"Raw Capacity\")), \"Raw Capacity Used %\")",
					"textEditor": true
				}],
				"thresholds": [{
					"colorMode": "critical",
					"fill": true,
					"line": true,
					"op": "gt",
					"value": 80
				}],
				"timeFrom": null,
				"timeShift": null,
				"title": "Cluster Capacity",
				"tooltip": {
					"shared": true,
					"sort": 0,
					"value_type": "individual"
				},
				"type": "graph",
				"xaxis": {
					"buckets": null,
					"mode": "time",
					"name": null,
					"show": true,
					"values": []
				},
				"yaxes": [{
					"format": "percent",
					"label": "",
					"logBase": 1,
					"max": "100",
					"min": "0",
					"show": true
				}, {
					"format": "short",
					"label": null,
					"logBase": 1,
					"max": null,
					"min": null,
					"show": false
				}]
			}, {
				"alert": {
					"conditions": [{
						"evaluator": {
							"params": [99],
							"type": "gt"
						},
						"operator": {
							"type": "and"
						},
						"query": {
							"params": ["A", "1m", "now"]
						},
						"reducer": {
							"params": [],
							"type": "avg"
						},
						"type": "query"
					}, {
						"evaluator": {
							"params": [1],
							"type": "lt"
						},
						"operator": {
							"type": "and"
						},
						"query": {
							"params": ["B", "1m", "now"]
						},
						"reducer": {
							"params": [],
							"type": "max"
						},
						"type": "query"
					}],
					"executionErrorState": "alerting",
					"frequency": "30s",
					"handler": 1,
					"message": "Potential Disk Stall",
					"name": "Disk I/O Stalls",
					"noDataState": "no_data",
					"notifications": []
				},
				"aliasColors": {},
				"bars": false,
				"dashLength": 10,
				"dashes": false,
				"datasource": null,
				"description": "This chart covers the last 15mins of high disk utilization. In some environments the hardware/firmware defects can manifest as I/O timeouts and bus resets. When this occurs the %util on the drive will block at 100% for an extended period. This trigger aims to pick up on these types of events",
				"fill": 1,
				"hideTimeOverride": true,
				"id": 6,
				"legend": {
					"avg": false,
					"current": false,
					"max": false,
					"min": false,
					"show": true,
					"total": false,
					"values": false
				},
				"lines": true,
				"linewidth": 1,
				"links": [],
				"minSpan": 2,
				"nullPointMode": "null",
				"percentage": false,
				"pointradius": 5,
				"points": false,
				"renderer": "flot",
				"seriesOverrides": [],
				"spaceLength": 10,
				"span": 2,
				"stack": false,
				"steppedLine": false,
				"targets": [{
					"refId": "A",
					"target": "aliasByNode(currentAbove(collectd.*.$domain.cephmetrics.gauge.*.osd.*.perf.util,99),1,-3)",
					"textEditor": true
				}, {
					"hide": true,
					"refId": "B",
					"target": "aliasByNode(currentBelow(collectd.*.$domain.cephmetrics.gauge.*.osd.*.perf.iops,1),1,-3)",
					"textEditor": true
				}],
				"thresholds": [{
					"colorMode": "critical",
					"fill": true,
					"line": true,
					"op": "gt",
					"value": 99
				}],
				"timeFrom": "15m",
				"timeShift": null,
				"title": "Disk I/O Stalls",
				"tooltip": {
					"shared": true,
					"sort": 0,
					"value_type": "individual"
				},
				"type": "graph",
				"xaxis": {
					"buckets": null,
					"mode": "time",
					"name": null,
					"show": true,
					"values": []
				},
				"yaxes": [{
					"format": "short",
					"label": "",
					"logBase": 1,
					"max": "100",
					"min": "0",
					"show": true
				}, {
					"format": "short",
					"label": null,
					"logBase": 1,
					"max": null,
					"min": null,
					"show": true
				}]
			}, {
				"alert": {
					"conditions": [{
						"evaluator": {
							"params": [0],
							"type": "gt"
						},
						"operator": {
							"type": "and"
						},
						"query": {
							"params": ["A", "4h", "now"]
						},
						"reducer": {
							"params": [],
							"type": "avg"
						},
						"type": "query"
					}],
					"executionErrorState": "alerting",
					"frequency": "60s",
					"handler": 1,
					"message": "PG peering is a taking a long time to finish",
					"name": "PG Peering Delay",
					"noDataState": "ok",
					"notifications": []
				},
				"aliasColors": {},
				"bars": false,
				"dashLength": 10,
				"dashes": false,
				"datasource": null,
				"description": "This chart shows the pg peering state over the last 6 hours. If peering has been ongoing for more than 4hrs, this alert will trigger to prompt further investigation on the ceph cluster",
				"fill": 1,
				"hideTimeOverride": true,
				"id": 7,
				"legend": {
					"avg": false,
					"current": false,
					"max": false,
					"min": false,
					"show": false,
					"total": false,
					"values": false
				},
				"lines": true,
				"linewidth": 1,
				"links": [],
				"minSpan": 2,
				"nullPointMode": "null",
				"percentage": false,
				"pointradius": 5,
				"points": false,
				"renderer": "flot",
				"seriesOverrides": [],
				"spaceLength": 10,
				"span": 2,
				"stack": false,
				"steppedLine": false,
				"targets": [{
					"refId": "A",
					"target": "alias(maxSeries(consolidateBy(collectd.*.$domain.cephmetrics.gauge.*.mon.num_pg_peering, \"maxSeries\")), \"# pg's in peering state\")",
					"textEditor": true
				}],
				"thresholds": [{
					"colorMode": "critical",
					"fill": true,
					"line": true,
					"op": "gt",
					"value": 0
				}],
				"timeFrom": "6h",
				"timeShift": null,
				"title": "PG Peering State",
				"tooltip": {
					"shared": false,
					"sort": 0,
					"value_type": "individual"
				},
				"type": "graph",
				"xaxis": {
					"buckets": null,
					"mode": "time",
					"name": null,
					"show": true,
					"values": ["total"]
				},
				"yaxes": [{
					"format": "short",
					"label": null,
					"logBase": 1,
					"max": null,
					"min": "0",
					"show": true
				}, {
					"format": "short",
					"label": null,
					"logBase": 1,
					"max": null,
					"min": null,
					"show": false
				}]
			}, {
				"alert": {
					"conditions": [{
						"evaluator": {
							"params": [0],
							"type": "gt"
						},
						"operator": {
							"type": "and"
						},
						"query": {
							"params": ["A", "1m", "now"]
						},
						"reducer": {
							"params": [],
							"type": "last"
						},
						"type": "query"
					}],
					"executionErrorState": "alerting",
					"frequency": "60s",
					"handler": 1,
					"message": "PG's stuck inactive",
					"name": "PG's Stuck",
					"noDataState": "no_data",
					"notifications": []
				},
				"aliasColors": {},
				"bars": false,
				"dashLength": 10,
				"dashes": false,
				"datasource": null,
				"description": "This chart shows whether there are pg's in a stuck state, that need manual intervention to resolve.",
				"fill": 2,
				"hideTimeOverride": true,
				"id": 8,
				"legend": {
					"avg": false,
					"current": false,
					"max": false,
					"min": false,
					"show": true,
					"total": false,
					"values": false
				},
				"lines": true,
				"linewidth": 2,
				"links": [],
				"minSpan": 2,
				"nullPointMode": "null",
				"percentage": false,
				"pointradius": 5,
				"points": false,
				"renderer": "flot",
				"seriesOverrides": [],
				"spaceLength": 10,
				"span": 2,
				"stack": false,
				"steppedLine": false,
				"targets": [{
					"refId": "A",
					"target": "alias(maxSeries(consolidateBy(collectd.*.$domain.cephmetrics.gauge.*.mon.num_pgs_stuck, \"maxSeries\")), \"# pg's stuck inactive\")",
					"textEditor": true
				}],
				"thresholds": [{
					"colorMode": "critical",
					"fill": true,
					"line": true,
					"op": "gt",
					"value": 0
				}],
				"timeFrom": "6h",
				"timeShift": null,
				"title": "PG's Stuck",
				"tooltip": {
					"shared": false,
					"sort": 0,
					"value_type": "individual"
				},
				"type": "graph",
				"xaxis": {
					"buckets": null,
					"mode": "time",
					"name": null,
					"show": true,
					"values": ["total"]
				},
				"yaxes": [{
					"format": "short",
					"label": null,
					"logBase": 1,
					"max": null,
					"min": "0",
					"show": true
				}, {
					"format": "short",
					"label": null,
					"logBase": 1,
					"max": null,
					"min": null,
					"show": false
				}]
			}],
			"repeat": null,
			"repeatIteration": null,
			"repeatRowId": null,
			"showTitle": true,
			"title": "Health Checks",
			"titleSize": "h5"
		}],
		"schemaVersion": 14,
		"style": "dark",
		"tags": [],
		"templating": {
			"list": []
		},
		"time": {
			"from": "now-24h",
			"to": "now"
		},
		"timepicker": {
			"refresh_intervals": ["5s", "10s", "30s", "1m", "5m", "15m", "30m", "1h", "2h", "1d"],
			"time_options": ["5m", "15m", "1h", "6h", "12h", "24h", "2d", "7d", "30d"]
		},
		"timezone": "browser",
		"title": "Alert Status",
		"version": 1
	}
}
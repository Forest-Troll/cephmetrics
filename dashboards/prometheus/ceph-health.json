{
   "dashboard": {
      "rows": [
         {
            "panels": [
               {
                  "datasource": "Prometheus", 
                  "targets": [
                     {
                        "intervalFactor": 2, 
                        "expr": "max(collectd_cephmetrics_gauge{cephmetrics=~\"ceph.mon.health\"})", 
                        "step": 2, 
                        "refId": "A", 
                        "format": "time_series"
                     }
                  ], 
                  "title": ""
               }
            ], 
            "title": "Dashboard Row"
         }, 
         {
            "panels": [
               {
                  "datasource": "Prometheus", 
                  "targets": [
                     {
                        "format": "time_series", 
                        "expr": "max(max_over_time(collectd_cephmetrics_gauge{cephmetrics=~\"ceph.mon.health\"}[5m]))", 
                        "step": 600, 
                        "legendFormat": "Ceph Health", 
                        "intervalFactor": 2, 
                        "refId": "A"
                     }
                  ], 
                  "title": "Health History - Last 3 days"
               }
            ], 
            "title": "Cluster Health"
         }, 
         {
            "panels": [
               {
                  "title": ""
               }, 
               {
                  "datasource": "Prometheus", 
                  "targets": [
                     {
                        "format": "time_series", 
                        "expr": "max(label_replace(collectd_cephmetrics_gauge{cephmetrics=~\"$cluster_name.mon.mon_status..*\"}, \"node\", \"$1\", \"instance\", \"(.*):.*\")) by (node)", 
                        "step": 2, 
                        "legendFormat": "{{node}}", 
                        "intervalFactor": 2, 
                        "refId": "B"
                     }
                  ], 
                  "title": "Monitor Status"
               }, 
               {
                  "title": ""
               }, 
               {
                  "title": ""
               }, 
               {
                  "datasource": "Prometheus", 
                  "targets": [
                     {
                        "intervalFactor": 2, 
                        "expr": "max(collectd_cephmetrics_gauge{cephmetrics=\"$cluster_name.mon.features.scrub\"})", 
                        "step": 2, 
                        "refId": "A", 
                        "format": "time_series"
                     }
                  ], 
                  "title": "SCRUB"
               }, 
               {
                  "datasource": "Prometheus", 
                  "targets": [
                     {
                        "intervalFactor": 2, 
                        "expr": "max(collectd_cephmetrics_gauge{cephmetrics=\"$cluster_name.mon.features.deep_scrub\"})", 
                        "step": 2, 
                        "refId": "A", 
                        "format": "time_series"
                     }
                  ], 
                  "title": "DEEP SCRUB"
               }, 
               {
                  "datasource": "Prometheus", 
                  "targets": [
                     {
                        "intervalFactor": 2, 
                        "expr": "max(collectd_cephmetrics_gauge{cephmetrics=\"$cluster_name.mon.features.recovery\"})", 
                        "step": 2, 
                        "refId": "A", 
                        "format": "time_series"
                     }
                  ], 
                  "title": "RECOVERY"
               }, 
               {
                  "datasource": "Prometheus", 
                  "targets": [
                     {
                        "intervalFactor": 2, 
                        "expr": "max(collectd_cephmetrics_gauge{cephmetrics=\"$cluster_name.mon.features.backfill\"})", 
                        "step": 2, 
                        "refId": "A", 
                        "format": "time_series"
                     }
                  ], 
                  "title": "BACKFILL"
               }, 
               {
                  "datasource": "Prometheus", 
                  "targets": [
                     {
                        "intervalFactor": 2, 
                        "expr": "max(collectd_cephmetrics_gauge{cephmetrics=\"$cluster_name.mon.features.rebalance\"})", 
                        "step": 2, 
                        "refId": "A", 
                        "format": "time_series"
                     }
                  ], 
                  "title": "REBALANCE"
               }, 
               {
                  "datasource": "Prometheus", 
                  "targets": [
                     {
                        "intervalFactor": 2, 
                        "expr": "max(collectd_cephmetrics_gauge{cephmetrics=\"$cluster_name.mon.features.out\"})", 
                        "step": 2, 
                        "refId": "A", 
                        "format": "time_series"
                     }
                  ], 
                  "title": "OUT"
               }, 
               {
                  "datasource": "Prometheus", 
                  "targets": [
                     {
                        "intervalFactor": 2, 
                        "expr": "max(collectd_cephmetrics_gauge{cephmetrics=\"$cluster_name.mon.features.down\"})", 
                        "step": 2, 
                        "refId": "A", 
                        "format": "time_series"
                     }
                  ], 
                  "title": "DOWN"
               }
            ], 
            "title": "Cluster State"
         }, 
         {
            "panels": [
               {
                  "datasource": "Prometheus", 
                  "targets": [
                     {
                        "format": "time_series", 
                        "expr": "avg(label_replace(collectd_cephmetrics_gauge{cephmetrics=~\"$cluster_name.osd.[0-9]*.osd_percent_used\"}, \"osd\", \"$1\", \"cephmetrics\", \"$cluster_name.osd.([0-9]*).osd_percent_used\")) by (osd) > $disk_full_threshold", 
                        "step": 60, 
                        "legendFormat": "{{osd}}", 
                        "intervalFactor": 2, 
                        "refId": "A"
                     }
                  ], 
                  "title": "Disks Near Full"
               }, 
               {
                  "datasource": "Prometheus", 
                  "targets": [
                     {
                        "hide": false, 
                        "format": "time_series", 
                        "expr": "avg(label_replace(collectd_cephmetrics_gauge{cephmetrics=~\"ceph.mon.osd_state.[0-9]*.up\"}, \"osd\", \"$1\", \"cephmetrics\", \"ceph.mon.osd_state.([0-9]*).up\")) by (osd) < 0.5", 
                        "step": 2, 
                        "legendFormat": "{{osd}}", 
                        "intervalFactor": 2, 
                        "refId": "B"
                     }
                  ], 
                  "title": "OSD's Down"
               }, 
               {
                  "datasource": "Prometheus", 
                  "targets": [
                     {
                        "hide": false, 
                        "format": "time_series", 
                        "expr": "avg(label_replace(collectd_cephmetrics_gauge{cephmetrics=~\"ceph.mon.osd_state.[0-9]*.in\"}, \"osd\", \"$1\", \"cephmetrics\", \"ceph.mon.osd_state.([0-9]*).in\")) by (osd) < 0.5", 
                        "step": 4, 
                        "legendFormat": "{{osd}}", 
                        "intervalFactor": 2, 
                        "refId": "B"
                     }
                  ], 
                  "title": "OSDs Out"
               }, 
               {
                  "title": ""
               }, 
               {
                  "datasource": "Prometheus", 
                  "targets": [
                     {
                        "tags": [], 
                        "expr": "max(collectd_cephmetrics_gauge{cephmetrics=\"$cluster_name.mon.num_object\"})", 
                        "format": "time_series", 
                        "groupBy": [
                           {
                              "params": [
                                 "$__interval"
                              ], 
                              "type": "time"
                           }, 
                           {
                              "params": [
                                 "null"
                              ], 
                              "type": "fill"
                           }
                        ], 
                        "alias": "Objects", 
                        "step": 20, 
                        "resultFormat": "time_series", 
                        "legendFormat": "Total Objects", 
                        "intervalFactor": 2, 
                        "refId": "A", 
                        "select": [
                           [
                              {
                                 "params": [
                                    "value"
                                 ], 
                                 "type": "field"
                              }, 
                              {
                                 "params": [], 
                                 "type": "mean"
                              }
                           ]
                        ]
                     }, 
                     {
                        "intervalFactor": 2, 
                        "tags": [], 
                        "expr": "max(collectd_cephmetrics_gauge{cephmetrics=\"$cluster_name.mon.num_object_degraded\"})", 
                        "format": "time_series", 
                        "groupBy": [
                           {
                              "params": [
                                 "$__interval"
                              ], 
                              "type": "time"
                           }, 
                           {
                              "params": [
                                 "null"
                              ], 
                              "type": "fill"
                           }
                        ], 
                        "alias": "Objects", 
                        "step": 20, 
                        "resultFormat": "time_series", 
                        "legendFormat": "Objects degraded", 
                        "policy": "default", 
                        "refId": "B", 
                        "select": [
                           [
                              {
                                 "params": [
                                    "value"
                                 ], 
                                 "type": "field"
                              }, 
                              {
                                 "params": [], 
                                 "type": "mean"
                              }
                           ]
                        ]
                     }, 
                     {
                        "intervalFactor": 2, 
                        "tags": [], 
                        "expr": "max(collectd_cephmetrics_gauge{cephmetrics=\"$cluster_name.mon.num_object_misplaced\"})", 
                        "format": "time_series", 
                        "groupBy": [
                           {
                              "params": [
                                 "$__interval"
                              ], 
                              "type": "time"
                           }, 
                           {
                              "params": [
                                 "null"
                              ], 
                              "type": "fill"
                           }
                        ], 
                        "alias": "Objects", 
                        "step": 20, 
                        "resultFormat": "time_series", 
                        "legendFormat": "Objects misplaced", 
                        "policy": "default", 
                        "refId": "C", 
                        "select": [
                           [
                              {
                                 "params": [
                                    "value"
                                 ], 
                                 "type": "field"
                              }, 
                              {
                                 "params": [], 
                                 "type": "mean"
                              }
                           ]
                        ]
                     }, 
                     {
                        "tags": [], 
                        "expr": "max(collectd_cephmetrics_gauge{cephmetrics=\"$cluster_name.mon.num_object_unfound\"})", 
                        "format": "time_series", 
                        "groupBy": [
                           {
                              "params": [
                                 "$__interval"
                              ], 
                              "type": "time"
                           }, 
                           {
                              "params": [
                                 "null"
                              ], 
                              "type": "fill"
                           }
                        ], 
                        "alias": "Objects", 
                        "step": 20, 
                        "resultFormat": "time_series", 
                        "legendFormat": "Objects unfound", 
                        "intervalFactor": 2, 
                        "refId": "D", 
                        "select": [
                           [
                              {
                                 "params": [
                                    "value"
                                 ], 
                                 "type": "field"
                              }, 
                              {
                                 "params": [], 
                                 "type": "mean"
                              }
                           ]
                        ]
                     }
                  ], 
                  "title": "Object Summary"
               }, 
               {
                  "title": ""
               }, 
               {
                  "datasource": "Prometheus", 
                  "targets": [
                     {
                        "tags": [], 
                        "expr": "max(collectd_cephmetrics_gauge{cephmetrics=\"$cluster_name.mon.num_pg\"})", 
                        "format": "time_series", 
                        "groupBy": [
                           {
                              "params": [
                                 "$__interval"
                              ], 
                              "type": "time"
                           }, 
                           {
                              "params": [
                                 "null"
                              ], 
                              "type": "fill"
                           }
                        ], 
                        "alias": "PG's", 
                        "step": 20, 
                        "resultFormat": "time_series", 
                        "legendFormat": "PGs", 
                        "intervalFactor": 2, 
                        "refId": "A", 
                        "select": [
                           [
                              {
                                 "params": [
                                    "value"
                                 ], 
                                 "type": "field"
                              }, 
                              {
                                 "params": [], 
                                 "type": "mean"
                              }
                           ]
                        ]
                     }, 
                     {
                        "tags": [], 
                        "expr": "max(collectd_cephmetrics_gauge{cephmetrics=\"$cluster_name.mon.num_pg_active\"})", 
                        "format": "time_series", 
                        "groupBy": [
                           {
                              "params": [
                                 "$__interval"
                              ], 
                              "type": "time"
                           }, 
                           {
                              "params": [
                                 "null"
                              ], 
                              "type": "fill"
                           }
                        ], 
                        "alias": "PG's", 
                        "step": 20, 
                        "resultFormat": "time_series", 
                        "legendFormat": "Active PGs", 
                        "intervalFactor": 2, 
                        "refId": "B", 
                        "select": [
                           [
                              {
                                 "params": [
                                    "value"
                                 ], 
                                 "type": "field"
                              }, 
                              {
                                 "params": [], 
                                 "type": "mean"
                              }
                           ]
                        ]
                     }, 
                     {
                        "tags": [], 
                        "expr": "max(collectd_cephmetrics_gauge{cephmetrics=\"$cluster_name.mon.num_pg_active_clean\"})", 
                        "format": "time_series", 
                        "groupBy": [
                           {
                              "params": [
                                 "$__interval"
                              ], 
                              "type": "time"
                           }, 
                           {
                              "params": [
                                 "null"
                              ], 
                              "type": "fill"
                           }
                        ], 
                        "alias": "PG's", 
                        "step": 20, 
                        "resultFormat": "time_series", 
                        "legendFormat": "Active+clean PGs", 
                        "intervalFactor": 2, 
                        "refId": "C", 
                        "select": [
                           [
                              {
                                 "params": [
                                    "value"
                                 ], 
                                 "type": "field"
                              }, 
                              {
                                 "params": [], 
                                 "type": "mean"
                              }
                           ]
                        ]
                     }, 
                     {
                        "tags": [], 
                        "expr": "max(collectd_cephmetrics_gauge{cephmetrics=\"$cluster_name.mon.num_pg_peering\"})", 
                        "format": "time_series", 
                        "groupBy": [
                           {
                              "params": [
                                 "$__interval"
                              ], 
                              "type": "time"
                           }, 
                           {
                              "params": [
                                 "null"
                              ], 
                              "type": "fill"
                           }
                        ], 
                        "alias": "PG's", 
                        "step": 20, 
                        "resultFormat": "time_series", 
                        "legendFormat": "PGs peering", 
                        "intervalFactor": 2, 
                        "refId": "D", 
                        "select": [
                           [
                              {
                                 "params": [
                                    "value"
                                 ], 
                                 "type": "field"
                              }, 
                              {
                                 "params": [], 
                                 "type": "mean"
                              }
                           ]
                        ]
                     }
                  ], 
                  "title": "PG Summary"
               }
            ], 
            "title": "Storage Information"
         }
      ], 
      "templating": {
         "list": [
            {
               "regex": "/cephmetrics=\"([^.]*)\\./", 
               "sort": 0, 
               "multi": false, 
               "hide": 2, 
               "name": "cluster_name", 
               "tags": [], 
               "allValue": null, 
               "tagsQuery": "", 
               "current": {
                  "text": "ceph", 
                  "value": "ceph"
               }, 
               "refresh": 1, 
               "label": null, 
               "tagValuesQuery": "", 
               "datasource": "Local", 
               "query": "collectd_cephmetrics_gauge{}", 
               "includeAll": false, 
               "type": "query", 
               "options": [], 
               "useTags": false
            }, 
            {
               "multi": false, 
               "hide": 2, 
               "name": "domain", 
               "allValue": null, 
               "label": null, 
               "current": {
                  "text": "fedex.lan", 
                  "value": "fedex.lan"
               }, 
               "query": "fedex.lan", 
               "type": "custom", 
               "options": [
                  {
                     "text": "fedex.lan", 
                     "selected": true, 
                     "value": "fedex.lan"
                  }
               ], 
               "includeAll": false
            }, 
            {
               "multi": true, 
               "hide": 2, 
               "name": "osd_servers", 
               "allValue": null, 
               "label": null, 
               "current": {
                  "text": "All", 
                  "selected": true, 
                  "value": "$__all"
               }, 
               "query": "node1,node2,node3", 
               "type": "custom", 
               "options": [
                  {
                     "text": "All", 
                     "selected": true, 
                     "value": "$__all"
                  }, 
                  {
                     "text": "node1", 
                     "selected": false, 
                     "value": "node1"
                  }, 
                  {
                     "text": "node2", 
                     "selected": false, 
                     "value": "node2"
                  }, 
                  {
                     "text": "node3", 
                     "selected": false, 
                     "value": "node3"
                  }
               ], 
               "includeAll": true
            }, 
            {
               "multi": false, 
               "hide": 2, 
               "name": "disk_full_threshold", 
               "allValue": null, 
               "label": null, 
               "current": {
                  "text": "85", 
                  "selected": true, 
                  "value": "85"
               }, 
               "query": "85", 
               "type": "custom", 
               "options": [
                  {
                     "text": "85", 
                     "selected": true, 
                     "value": "85"
                  }
               ], 
               "includeAll": false
            }
         ]
      }
   }
}